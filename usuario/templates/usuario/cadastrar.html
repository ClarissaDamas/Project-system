{% extends "System/base.html" %}

{% block content %}

<form method="post">
    {% csrf_token %}

    {% if form.errors %}
        <div style="background-color: #ffcccc; padding: 10px; border-radius: 5px; margin-bottom: 20px;">
            <strong>Por favor, corrija os erros abaixo:</strong>
            {{ form.non_field_errors }}
        </div>
    {% endif %}

    {% for field in form %}
        <div class="field-container">
            <label>{{ field.label }}</label>
            {{ field }}

            {% if field.errors %}
                <span style="color: red; font-size: 0.8em;">
                    {{ field.errors.0 }}
                </span>
            {% endif %}
        </div>
    {% endfor %}

    <button type="submit">Finalizar Cadastro</button>
</form>

<!-- JavaScript puro -->
<script>
document.addEventListener('DOMContentLoaded', function () {

    const cpfInput = document.getElementById('id_cpf');
    const telefoneInput = document.getElementById('id_telefone');

    if (cpfInput) {
        cpfInput.addEventListener('input', function () {
            this.value = maskCPF(this.value);
        });
    }

    if (telefoneInput) {
        telefoneInput.addEventListener('input', function () {
            this.value = maskTelefone(this.value);
        });
    }

    function maskCPF(value) {
        return value
            .replace(/\D/g, '')
            .replace(/(\d{3})(\d)/, '$1.$2')
            .replace(/(\d{3})(\d)/, '$1.$2')
            .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
    }

    function maskTelefone(value) {
        return value
            .replace(/\D/g, '')
            .replace(/(\d{2})(\d)/, '($1) $2')
            .replace(/(\d{5})(\d)/, '$1-$2');
    }

});
</script>


{% endblock content %}
